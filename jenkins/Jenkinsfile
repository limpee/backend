pipeline {

    agent any

    stages {

        stage('Checkout') {

            steps {

                echo "Teste de Hello Wordl!"

            }

        }

        stage('Move to keys directory') {

            steps {

                sh "cd /home/ec2-user/keys"

            }

        }

        stage('Grant key permission') {

            steps {

                sh "chmod 400 \"backend-key.pem\""

            }

        }

        stage('Access backend EC2') {

            steps {

                sh "ssh -i \"backend-key.pem\" ec2-user@ec2-3-214-52-91.compute-1.amazonaws.com"

            }

        }

    }

}