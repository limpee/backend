pipeline {
    agent any

    stages {
        stage('GIT TESTE') {
            steps {
                script {
                    // Ajustar as permiss√µes da chave SSH
                    sh 'chmod 400 /home/ec2-user/keys/backend-key.pem'

                    // Executar o comando SSH e os comandos Git dentro do mesmo script
                    sh '''
                        ssh -i /home/ec2-user/keys/backend-key.pem ec2-user@ec2-3-214-52-91.compute-1.amazonaws.com << 'ENDSSH'
                            cd /home/ec2-user/repo/backend
                            sudo git fetch
                            sudo git pull
                        ENDSSH
                    '''
                }
            }
        }
    }
}
